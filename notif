local Notif = {}

local CoreGUI = game:GetService("CoreGui")
local TS = game:GetService("TweenService")

local HIDEUI = get_hidden_gui or gethui
if syn and typeof(syn) == "table" and RenderWindow then syn.protect_gui = gethui; end

local function Hide_UI(gui)
    if HIDEUI then
        gui.Parent = HIDEUI()
    elseif (not is_sirhurt_closure) and (syn and syn.protect_gui) then
        syn.protect_gui(gui)
        gui.Parent = CoreGUI
    elseif CoreGUI:FindFirstChild('RobloxGui') then
        gui.Parent = CoreGUI.RobloxGui
    else
        gui.Parent = CoreGUI
    end
end

local screen_gui = Instance.new("ScreenGui")
Hide_UI(screen_gui)

local frame = Instance.new("Frame")
frame.AnchorPoint = Vector2.new(0.5, 0.95)
frame.BackgroundTransparency = 1
frame.BorderSizePixel = 0
frame.Position = UDim2.new(0.5, 0, 0.95, 0)
frame.Size = UDim2.new(0, 100, 0, 100)
frame.Parent = screen_gui

local uilist_layout = Instance.new("UIListLayout")
uilist_layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
uilist_layout.SortOrder = Enum.SortOrder.LayoutOrder
uilist_layout.VerticalAlignment = Enum.VerticalAlignment.Bottom
uilist_layout.Padding = UDim.new(0, 6)
uilist_layout.Parent = frame

function Notif.New(text, timee)
    local container = Instance.new("Frame")
    container.BackgroundTransparency = 1
    container.Size = UDim2.new(0, 100, 0, 0)
    container.Parent = frame

    -- Main frame
    local main = Instance.new("Frame")
    main.AnchorPoint = Vector2.new(0.5, 1)
    main.AutomaticSize = Enum.AutomaticSize.X
    main.BackgroundColor3 = Color3.fromRGB(36, 36, 36)
    main.BackgroundTransparency = 0.15
    main.Position = UDim2.new(0.5, 0, 1, 60)
    main.Size = UDim2.new(0, 0, 0, 45) -- to hơn
    main.Parent = container

    local uicorner = Instance.new("UICorner")
    uicorner.CornerRadius = UDim.new(0, 8)
    uicorner.Parent = main

    local uipadding = Instance.new("UIPadding")
    uipadding.PaddingLeft = UDim.new(0, 8)
    uipadding.PaddingRight = UDim.new(0, 8)
    uipadding.PaddingTop = UDim.new(0, 6)
    uipadding.PaddingBottom = UDim.new(0, 6)
    uipadding.Parent = main

    local uistroke = Instance.new("UIStroke")
    uistroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    uistroke.Color = Color3.fromRGB(15, 15, 15)
    uistroke.Thickness = 1
    uistroke.Parent = main

    -- Logo
    local logo = Instance.new("ImageLabel")
    logo.Image = "rbxassetid://112766731573756"
    logo.Size = UDim2.new(0, 28, 0, 28)
    logo.BackgroundTransparency = 1
    logo.AnchorPoint = Vector2.new(0, 0.5)
    logo.Position = UDim2.new(0, 0, 0.5, 0)
    logo.Parent = main

    -- Text
    local text_label = Instance.new("TextLabel")
    text_label.Font = Enum.Font.Gotham
    text_label.Text = text
    text_label.TextColor3 = Color3.fromRGB(200, 200, 200)
    text_label.TextSize = 15
    text_label.AutomaticSize = Enum.AutomaticSize.X
    text_label.BackgroundTransparency = 1
    text_label.Position = UDim2.new(0, 35, 0, 0) -- đẩy sang phải để tránh logo
    text_label.Size = UDim2.new(1, -70, 1, 0)
    text_label.TextXAlignment = Enum.TextXAlignment.Left
    text_label.Parent = main

    local close_btn = Instance.new("TextButton")
    close_btn.Size = UDim2.new(0, 24, 0, 24)
    close_btn.AnchorPoint = Vector2.new(1, 0.5)
    close_btn.Position = UDim2.new(1, 0, 0.5, 0)
    close_btn.BackgroundTransparency = 1
    close_btn.Text = ""
    close_btn.Parent = main

    local close_icon = Instance.new("ImageButton")
    close_icon.Image = "rbxassetid://3926305904"
    close_icon.ImageColor3 = Color3.fromRGB(200, 200, 200)
    close_icon.ImageRectOffset = Vector2.new(924, 724)
    close_icon.ImageRectSize = Vector2.new(36, 36)
    close_icon.Size = UDim2.new(0, 18, 0, 18)
    close_icon.AnchorPoint = Vector2.new(0.5, 0.5)
    close_icon.Position = UDim2.new(0.5, 0, 0.5, 0)
    close_icon.BackgroundTransparency = 1
    close_icon.Parent = close_btn

    -- Tween xuất hiện
    TS:Create(main, TweenInfo.new(0.2, Enum.EasingStyle.Quint), { Position = UDim2.new(0.5, 0, 1, 0) }):Play()
    TS:Create(container, TweenInfo.new(0.2, Enum.EasingStyle.Quint), { Size = UDim2.new(0, 100, 0, 45) }):Play()

    -- Close
    local function close_notif()
        TS:Create(text_label, TweenInfo.new(0.15), {TextTransparency = 1}):Play()
        TS:Create(logo, TweenInfo.new(0.15), {ImageTransparency = 1}):Play()
        TS:Create(main, TweenInfo.new(0.25), {BackgroundTransparency = 1}):Play()
        TS:Create(uistroke, TweenInfo.new(0.25), {Transparency = 1}):Play()
        task.wait(0.25)
        container:Destroy()
    end

    close_btn.MouseButton1Click:Connect(close_notif)
    task.delay(tonumber(timee) and timee or 5, close_notif)
end

return Notif
